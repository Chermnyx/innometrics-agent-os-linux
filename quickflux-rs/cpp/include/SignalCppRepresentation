#pragma once

#include <QtCore/QObject>
#include <QtCore/QEvent>
#include <QtCore/QDebug>

union SignalCppRepresentation {
    void (QObject::*cpp_signal)();
    qintptr rust_signal;

    SignalCppRepresentation() = default;

    // Construct the object from an arbitrary signal.
    // (there is a double indirection in the reinterpret_cast to avoid -Wcast-function-type)
    template<typename R, typename Object, typename ...Args>
    SignalCppRepresentation(R (Object::*cpp_signal)(Args...))
            : cpp_signal(*reinterpret_cast<void (QObject::**)()>(&cpp_signal)) { }
};

struct TraitObject {
    void *a;
    void *b;
    explicit operator bool() const { return a && b; }
};
